<!doctype html><html lang=zh-hans dir=" ltr">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="3.3.1 #  解答 #  结果如下：
E AE |--E--| A S |--E--| A SY |--ES--| A Q Y |--ES--| A Q UY |--------S--------| |--E--| |--U--| A Q T Y |--------S--------| |--E--| |--U--| A IQ T Y |--------S--------| |--EO--| |--U--| A I Q T Y |--------S--------| |--EO--| |--U--| A IN Q T Y 代码 #  2-3 树的实现
using System; using System.Collections.Generic; using System.Linq; using System.Text; // ReSharper disable CognitiveComplexity  namespace BalancedSearchTree { /// <summary>  /// 2-3 树。  /// </summary>  /// <typeparam name=&#34;TKey&#34;>键。</typeparam>  /// <typeparam name=&#34;TValue&#34;>值。</typeparam>  public class TwoThreeBst<TKey, TValue> : IOrderedSt<TKey, TValue> where TKey : IComparable<TKey> { private int _count; private Node _root; /// <inheritdoc />  public void Put(TKey key, TValue value) { if (_root == null) { _root = new Node(null); _root.">
<meta name=theme-color content="#FFFFFF">
<meta name=color-scheme content="light dark"><meta property="og:title" content="3.3.1">
<meta property="og:description" content="3.3.1 #  解答 #  结果如下：
E AE |--E--| A S |--E--| A SY |--ES--| A Q Y |--ES--| A Q UY |--------S--------| |--E--| |--U--| A Q T Y |--------S--------| |--E--| |--U--| A IQ T Y |--------S--------| |--EO--| |--U--| A I Q T Y |--------S--------| |--EO--| |--U--| A IN Q T Y 代码 #  2-3 树的实现
using System; using System.Collections.Generic; using System.Linq; using System.Text; // ReSharper disable CognitiveComplexity  namespace BalancedSearchTree { /// <summary>  /// 2-3 树。  /// </summary>  /// <typeparam name=&#34;TKey&#34;>键。</typeparam>  /// <typeparam name=&#34;TValue&#34;>值。</typeparam>  public class TwoThreeBst<TKey, TValue> : IOrderedSt<TKey, TValue> where TKey : IComparable<TKey> { private int _count; private Node _root; /// <inheritdoc />  public void Put(TKey key, TValue value) { if (_root == null) { _root = new Node(null); _root.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://alg4.ikesnowy.com/3-3-1/"><meta property="article:section" content>
<meta property="article:published_time" content="2021-09-06T00:22:07+00:00">
<meta property="article:modified_time" content="2022-02-22T22:22:44+08:00">
<title>3.3.1 | 《算法（第四版）》C# 题解</title>
<link rel=manifest href=/manifest.json>
<link rel=icon href=/favicon.png type=image/x-icon>
<link rel=stylesheet href=/book.min.97cfda4f5e3c9fa49a2bf8d401f4ddc0eec576c99cdcf6afbec19173200c37db.css integrity="sha256-l8/aT148n6SaK/jUAfTdwO7Fdsmc3PavvsGRcyAMN9s=" crossorigin=anonymous>
<script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.b2a0767f9469ac20ee81edb4b1787ac657456f9dbeef4bd12acd4710e5939568.js integrity="sha256-sqB2f5RprCDuge20sXh6xldFb52+70vRKs1HEOWTlWg=" crossorigin=anonymous></script>
<script>window.katexOption={delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]}</script>
<link rel=stylesheet href=/katex/katex.min.css>
<script defer src=/katex/katex.min.js></script>
<script defer src=/katex/auto-render.min.js onload=renderMathInElement(document.body,window.katexOption)></script>
</head>
<body dir=" ltr">
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a class="flex align-center" href=/><span>《算法（第四版）》C# 题解</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li>
<a href=/1-1-1/>1.1.1</a>
</li>
<li>
<a href=/1-1-2/>1.1.2</a>
</li>
<li>
<a href=/1-1-3/>1.1.3</a>
</li>
<li>
<a href=/1-1-4/>1.1.4</a>
</li>
<li>
<a href=/1-1-5/>1.1.5</a>
</li>
<li>
<a href=/1-1-6/>1.1.6</a>
</li>
<li>
<a href=/1-1-7/>1.1.7</a>
</li>
<li>
<a href=/1-1-8/>1.1.8</a>
</li>
<li>
<a href=/1-1-9/>1.1.9</a>
</li>
<li>
<a href=/1-1-10/>1.1.10</a>
</li>
<li>
<a href=/1-1-11/>1.1.11</a>
</li>
<li>
<a href=/1-1-12/>1.1.12</a>
</li>
<li>
<a href=/1-1-13/>1.1.13</a>
</li>
<li>
<a href=/1-1-14/>1.1.14</a>
</li>
<li>
<a href=/1-1-15/>1.1.15</a>
</li>
<li>
<a href=/1-1-16/>1.1.16</a>
</li>
<li>
<a href=/1-1-17/>1.1.17</a>
</li>
<li>
<a href=/1-1-18/>1.1.18</a>
</li>
<li>
<a href=/1-1-19/>1.1.19</a>
</li>
<li>
<a href=/1-1-20/>1.1.20</a>
</li>
<li>
<a href=/1-1-21/>1.1.21</a>
</li>
<li>
<a href=/1-1-22/>1.1.22</a>
</li>
<li>
<a href=/1-1-23/>1.1.23</a>
</li>
<li>
<a href=/1-1-24/>1.1.24</a>
</li>
<li>
<a href=/1-1-25/>1.1.25</a>
</li>
<li>
<a href=/1-1-26/>1.1.26</a>
</li>
<li>
<a href=/1-1-27/>1.1.27</a>
</li>
<li>
<a href=/1-1-28/>1.1.28</a>
</li>
<li>
<a href=/1-1-29/>1.1.29</a>
</li>
<li>
<a href=/1-1-30/>1.1.30</a>
</li>
<li>
<a href=/1-1-31/>1.1.31</a>
</li>
<li>
<a href=/1-1-32/>1.1.32</a>
</li>
<li>
<a href=/1-1-33/>1.1.33</a>
</li>
<li>
<a href=/1-1-34/>1.1.34</a>
</li>
<li>
<a href=/1-1-35/>1.1.35</a>
</li>
<li>
<a href=/1-1-36/>1.1.36</a>
</li>
<li>
<a href=/1-1-37/>1.1.37</a>
</li>
<li>
<a href=/1-1-38/>1.1.38</a>
</li>
<li>
<a href=/1-1-39/>1.1.39</a>
</li>
<li>
<a href=/1-2-1/>1.2.1</a>
</li>
<li>
<a href=/1-2-2/>1.2.2</a>
</li>
<li>
<a href=/1-2-3/>1.2.3</a>
</li>
<li>
<a href=/1-2-4/>1.2.4</a>
</li>
<li>
<a href=/1-2-5/>1.2.5</a>
</li>
<li>
<a href=/1-2-6/>1.2.6</a>
</li>
<li>
<a href=/1-2-7/>1.2.7</a>
</li>
<li>
<a href=/1-2-8/>1.2.8</a>
</li>
<li>
<a href=/1-2-9/>1.2.9</a>
</li>
<li>
<a href=/1-2-10/>1.2.10</a>
</li>
<li>
<a href=/1-2-11/>1.2.11</a>
</li>
<li>
<a href=/1-2-12/>1.2.12</a>
</li>
<li>
<a href=/1-2-13/>1.2.13</a>
</li>
<li>
<a href=/1-2-14/>1.2.14</a>
</li>
<li>
<a href=/1-2-15/>1.2.15</a>
</li>
<li>
<a href=/1-2-16/>1.2.16</a>
</li>
<li>
<a href=/1-2-17/>1.2.17</a>
</li>
<li>
<a href=/1-2-18/>1.2.18</a>
</li>
<li>
<a href=/1-2-19/>1.2.19</a>
</li>
<li>
<a href=/1-3-1/>1.3.1</a>
</li>
<li>
<a href=/1-3-2/>1.3.2</a>
</li>
<li>
<a href=/1-3-3/>1.3.3</a>
</li>
<li>
<a href=/1-3-4/>1.3.4</a>
</li>
<li>
<a href=/1-3-5/>1.3.5</a>
</li>
<li>
<a href=/1-3-6/>1.3.6</a>
</li>
<li>
<a href=/1-3-7/>1.3.7</a>
</li>
<li>
<a href=/1-3-8/>1.3.8</a>
</li>
<li>
<a href=/1-3-9/>1.3.9</a>
</li>
<li>
<a href=/1-3-10/>1.3.10</a>
</li>
<li>
<a href=/1-3-11/>1.3.11</a>
</li>
<li>
<a href=/1-3-12/>1.3.12</a>
</li>
<li>
<a href=/1-3-13/>1.3.13</a>
</li>
<li>
<a href=/1-3-14/>1.3.14</a>
</li>
<li>
<a href=/1-3-15/>1.3.15</a>
</li>
<li>
<a href=/1-3-16/>1.3.16</a>
</li>
<li>
<a href=/1-3-17/>1.3.17</a>
</li>
<li>
<a href=/1-3-18/>1.3.18</a>
</li>
<li>
<a href=/1-3-19/>1.3.19</a>
</li>
<li>
<a href=/1-3-20/>1.3.20</a>
</li>
<li>
<a href=/1-3-21/>1.3.21</a>
</li>
<li>
<a href=/1-3-22/>1.3.22</a>
</li>
<li>
<a href=/1-3-23/>1.3.23</a>
</li>
<li>
<a href=/1-3-24/>1.3.24</a>
</li>
<li>
<a href=/1-3-25/>1.3.25</a>
</li>
<li>
<a href=/1-3-26/>1.3.26</a>
</li>
<li>
<a href=/1-3-27/>1.3.27</a>
</li>
<li>
<a href=/1-3-28/>1.3.28</a>
</li>
<li>
<a href=/1-3-29/>1.3.29</a>
</li>
<li>
<a href=/1-3-30/>1.3.30</a>
</li>
<li>
<a href=/1-3-31/>1.3.31</a>
</li>
<li>
<a href=/1-3-32/>1.3.32</a>
</li>
<li>
<a href=/1-3-33/>1.3.33</a>
</li>
<li>
<a href=/1-3-34/>1.3.34</a>
</li>
<li>
<a href=/1-3-35/>1.3.35</a>
</li>
<li>
<a href=/1-3-36/>1.3.36</a>
</li>
<li>
<a href=/1-3-37/>1.3.37</a>
</li>
<li>
<a href=/1-3-38/>1.3.38</a>
</li>
<li>
<a href=/1-3-39/>1.3.39</a>
</li>
<li>
<a href=/1-3-40/>1.3.40</a>
</li>
<li>
<a href=/1-3-41/>1.3.41</a>
</li>
<li>
<a href=/1-3-42/>1.3.42</a>
</li>
<li>
<a href=/1-3-43/>1.3.43</a>
</li>
<li>
<a href=/1-3-44/>1.3.44</a>
</li>
<li>
<a href=/1-3-45/>1.3.45</a>
</li>
<li>
<a href=/1-3-46/>1.3.46</a>
</li>
<li>
<a href=/1-3-47/>1.3.47</a>
</li>
<li>
<a href=/1-3-48/>1.3.48</a>
</li>
<li>
<a href=/1-3-49/>1.3.49</a>
</li>
<li>
<a href=/1-3-50/>1.3.50</a>
</li>
<li>
<a href=/1-4-1/>1.4.1</a>
</li>
<li>
<a href=/1-4-2/>1.4.2</a>
</li>
<li>
<a href=/1-4-3/>1.4.3</a>
</li>
<li>
<a href=/1-4-4/>1.4.4</a>
</li>
<li>
<a href=/1-4-5/>1.4.5</a>
</li>
<li>
<a href=/1-4-6/>1.4.6</a>
</li>
<li>
<a href=/1-4-7/>1.4.7</a>
</li>
<li>
<a href=/1-4-8/>1.4.8</a>
</li>
<li>
<a href=/1-4-9/>1.4.9</a>
</li>
<li>
<a href=/1-4-10/>1.4.10</a>
</li>
<li>
<a href=/1-4-11/>1.4.11</a>
</li>
<li>
<a href=/1-4-12/>1.4.12</a>
</li>
<li>
<a href=/1-4-13/>1.4.13</a>
</li>
<li>
<a href=/1-4-14/>1.4.14</a>
</li>
<li>
<a href=/1-4-15/>1.4.15</a>
</li>
<li>
<a href=/1-4-16/>1.4.16</a>
</li>
<li>
<a href=/1-4-17/>1.4.17</a>
</li>
<li>
<a href=/1-4-18/>1.4.18</a>
</li>
<li>
<a href=/1-4-19/>1.4.19</a>
</li>
<li>
<a href=/1-4-20/>1.4.20</a>
</li>
<li>
<a href=/1-4-21/>1.4.21</a>
</li>
<li>
<a href=/1-4-22/>1.4.22</a>
</li>
<li>
<a href=/1-4-23/>1.4.23</a>
</li>
<li>
<a href=/1-4-24/>1.4.24</a>
</li>
<li>
<a href=/1-4-25/>1.4.25</a>
</li>
<li>
<a href=/1-4-26/>1.4.26</a>
</li>
<li>
<a href=/1-4-27/>1.4.27</a>
</li>
<li>
<a href=/1-4-28/>1.4.28</a>
</li>
<li>
<a href=/1-4-29/>1.4.29</a>
</li>
<li>
<a href=/1-4-30/>1.4.30</a>
</li>
<li>
<a href=/1-4-31/>1.4.31</a>
</li>
<li>
<a href=/1-4-32/>1.4.32</a>
</li>
<li>
<a href=/1-4-33/>1.4.33</a>
</li>
<li>
<a href=/1-4-34/>1.4.34</a>
</li>
<li>
<a href=/1-4-35/>1.4.35</a>
</li>
<li>
<a href=/1-4-36/>1.4.36</a>
</li>
<li>
<a href=/1-4-37/>1.4.37</a>
</li>
<li>
<a href=/1-4-38/>1.4.38</a>
</li>
<li>
<a href=/1-4-39/>1.4.39</a>
</li>
<li>
<a href=/1-4-40/>1.4.40</a>
</li>
<li>
<a href=/1-4-41/>1.4.41</a>
</li>
<li>
<a href=/1-4-42/>1.4.42</a>
</li>
<li>
<a href=/1-4-43/>1.4.43</a>
</li>
<li>
<a href=/1-4-44/>1.4.44</a>
</li>
<li>
<a href=/1-4-45/>1.4.45</a>
</li>
<li>
<a href=/1-5-1/>1.5.1</a>
</li>
<li>
<a href=/1-5-2/>1.5.2</a>
</li>
<li>
<a href=/1-5-3/>1.5.3</a>
</li>
<li>
<a href=/1-5-4/>1.5.4</a>
</li>
<li>
<a href=/1-5-5/>1.5.5</a>
</li>
<li>
<a href=/1-5-6/>1.5.6</a>
</li>
<li>
<a href=/1-5-7/>1.5.7</a>
</li>
<li>
<a href=/1-5-8/>1.5.8</a>
</li>
<li>
<a href=/1-5-9/>1.5.9</a>
</li>
<li>
<a href=/1-5-10/>1.5.10</a>
</li>
<li>
<a href=/1-5-11/>1.5.11</a>
</li>
<li>
<a href=/1-5-12/>1.5.12</a>
</li>
<li>
<a href=/1-5-13/>1.5.13</a>
</li>
<li>
<a href=/1-5-14/>1.5.14</a>
</li>
<li>
<a href=/1-5-15/>1.5.15</a>
</li>
<li>
<a href=/1-5-16/>1.5.16</a>
</li>
<li>
<a href=/1-5-17/>1.5.17</a>
</li>
<li>
<a href=/1-5-18/>1.5.18</a>
</li>
<li>
<a href=/1-5-19/>1.5.19</a>
</li>
<li>
<a href=/1-5-20/>1.5.20</a>
</li>
<li>
<a href=/1-5-21/>1.5.21</a>
</li>
<li>
<a href=/1-5-22/>1.5.22</a>
</li>
<li>
<a href=/1-5-23/>1.5.23</a>
</li>
<li>
<a href=/1-5-24/>1.5.24</a>
</li>
<li>
<a href=/1-5-25/>1.5.25</a>
</li>
<li>
<a href=/1-5-26/>1.5.26</a>
</li>
<li>
<a href=/2-1-1/>2.1.1</a>
</li>
<li>
<a href=/2-1-2/>2.1.2</a>
</li>
<li>
<a href=/2-1-3/>2.1.3</a>
</li>
<li>
<a href=/2-1-4/>2.1.4</a>
</li>
<li>
<a href=/2-1-5/>2.1.5</a>
</li>
<li>
<a href=/2-1-6/>2.1.6</a>
</li>
<li>
<a href=/2-1-7/>2.1.7</a>
</li>
<li>
<a href=/2-1-8/>2.1.8</a>
</li>
<li>
<a href=/2-1-9/>2.1.9</a>
</li>
<li>
<a href=/2-1-10/>2.1.10</a>
</li>
<li>
<a href=/2-1-11/>2.1.11</a>
</li>
<li>
<a href=/2-1-12/>2.1.12</a>
</li>
<li>
<a href=/2-1-13/>2.1.13</a>
</li>
<li>
<a href=/2-1-14/>2.1.14</a>
</li>
<li>
<a href=/2-1-15/>2.1.15</a>
</li>
<li>
<a href=/2-1-16/>2.1.16</a>
</li>
<li>
<a href=/2-1-17/>2.1.17</a>
</li>
<li>
<a href=/2-1-18/>2.1.18</a>
</li>
<li>
<a href=/2-1-19/>2.1.19</a>
</li>
<li>
<a href=/2-1-20/>2.1.20</a>
</li>
<li>
<a href=/2-1-21/>2.1.21</a>
</li>
<li>
<a href=/2-1-22/>2.1.22</a>
</li>
<li>
<a href=/2-1-23/>2.1.23</a>
</li>
<li>
<a href=/2-1-24/>2.1.24</a>
</li>
<li>
<a href=/2-1-25/>2.1.25</a>
</li>
<li>
<a href=/2-1-26/>2.1.26</a>
</li>
<li>
<a href=/2-1-27/>2.1.27</a>
</li>
<li>
<a href=/2-1-28/>2.1.28</a>
</li>
<li>
<a href=/2-1-29/>2.1.29</a>
</li>
<li>
<a href=/2-1-30/>2.1.30</a>
</li>
<li>
<a href=/2-1-31/>2.1.31</a>
</li>
<li>
<a href=/2-1-32/>2.1.32</a>
</li>
<li>
<a href=/2-1-33/>2.1.33</a>
</li>
<li>
<a href=/2-1-34/>2.1.34</a>
</li>
<li>
<a href=/2-1-35/>2.1.35</a>
</li>
<li>
<a href=/2-1-36/>2.1.36</a>
</li>
<li>
<a href=/2-1-37/>2.1.37</a>
</li>
<li>
<a href=/2-1-38/>2.1.38</a>
</li>
<li>
<a href=/2-2-1/>2.2.1</a>
</li>
<li>
<a href=/2-2-2/>2.2.2</a>
</li>
<li>
<a href=/2-2-3/>2.2.3</a>
</li>
<li>
<a href=/2-2-4/>2.2.4</a>
</li>
<li>
<a href=/2-2-5/>2.2.5</a>
</li>
<li>
<a href=/2-2-6/>2.2.6</a>
</li>
<li>
<a href=/2-2-7/>2.2.7</a>
</li>
<li>
<a href=/2-2-8/>2.2.8</a>
</li>
<li>
<a href=/2-2-9/>2.2.9</a>
</li>
<li>
<a href=/2-2-10/>2.2.10</a>
</li>
<li>
<a href=/2-2-11/>2.2.11</a>
</li>
<li>
<a href=/2-2-12/>2.2.12</a>
</li>
<li>
<a href=/2-2-13/>2.2.13</a>
</li>
<li>
<a href=/2-2-14/>2.2.14</a>
</li>
<li>
<a href=/2-2-15/>2.2.15</a>
</li>
<li>
<a href=/2-2-16/>2.2.16</a>
</li>
<li>
<a href=/2-2-17/>2.2.17</a>
</li>
<li>
<a href=/2-2-18/>2.2.18</a>
</li>
<li>
<a href=/2-2-19/>2.2.19</a>
</li>
<li>
<a href=/2-2-20/>2.2.20</a>
</li>
<li>
<a href=/2-2-21/>2.2.21</a>
</li>
<li>
<a href=/2-2-22/>2.2.22</a>
</li>
<li>
<a href=/2-2-23/>2.2.23</a>
</li>
<li>
<a href=/2-2-24/>2.2.24</a>
</li>
<li>
<a href=/2-2-25/>2.2.25</a>
</li>
<li>
<a href=/2-2-26/>2.2.26</a>
</li>
<li>
<a href=/2-2-27/>2.2.27</a>
</li>
<li>
<a href=/2-2-28/>2.2.28</a>
</li>
<li>
<a href=/2-2-29/>2.2.29</a>
</li>
<li>
<a href=/2-3-1/>2.3.1</a>
</li>
<li>
<a href=/2-3-2/>2.3.2</a>
</li>
<li>
<a href=/2-3-3/>2.3.3</a>
</li>
<li>
<a href=/2-3-4/>2.3.4</a>
</li>
<li>
<a href=/2-3-5/>2.3.5</a>
</li>
<li>
<a href=/2-3-6/>2.3.6</a>
</li>
<li>
<a href=/2-3-7/>2.3.7</a>
</li>
<li>
<a href=/2-3-8/>2.3.8</a>
</li>
<li>
<a href=/2-3-9/>2.3.9</a>
</li>
<li>
<a href=/2-3-10/>2.3.10</a>
</li>
<li>
<a href=/2-3-11/>2.3.11</a>
</li>
<li>
<a href=/2-3-12/>2.3.12</a>
</li>
<li>
<a href=/2-3-13/>2.3.13</a>
</li>
<li>
<a href=/2-3-14/>2.3.14</a>
</li>
<li>
<a href=/2-3-15/>2.3.15</a>
</li>
<li>
<a href=/2-3-16/>2.3.16</a>
</li>
<li>
<a href=/2-3-17/>2.3.17</a>
</li>
<li>
<a href=/2-3-18/>2.3.18</a>
</li>
<li>
<a href=/2-3-19/>2.3.19</a>
</li>
<li>
<a href=/2-3-20/>2.3.20</a>
</li>
<li>
<a href=/2-3-21/>2.3.21</a>
</li>
<li>
<a href=/2-3-22/>2.3.22</a>
</li>
<li>
<a href=/2-3-23/>2.3.23</a>
</li>
<li>
<a href=/2-3-24/>2.3.24</a>
</li>
<li>
<a href=/2-3-25/>2.3.25</a>
</li>
<li>
<a href=/2-3-26/>2.3.26</a>
</li>
<li>
<a href=/2-3-27/>2.3.27</a>
</li>
<li>
<a href=/2-3-28/>2.3.28</a>
</li>
<li>
<a href=/2-3-29/>2.3.29</a>
</li>
<li>
<a href=/2-3-30/>2.3.30</a>
</li>
<li>
<a href=/2-3-31/>2.3.31</a>
</li>
<li>
<a href=/2-4-1/>2.4.1</a>
</li>
<li>
<a href=/2-4-2/>2.4.2</a>
</li>
<li>
<a href=/2-4-3/>2.4.3</a>
</li>
<li>
<a href=/2-4-4/>2.4.4</a>
</li>
<li>
<a href=/2-4-5/>2.4.5</a>
</li>
<li>
<a href=/2-4-6/>2.4.6</a>
</li>
<li>
<a href=/2-4-7/>2.4.7</a>
</li>
<li>
<a href=/2-4-8/>2.4.8</a>
</li>
<li>
<a href=/2-4-9/>2.4.9</a>
</li>
<li>
<a href=/2-4-10/>2.4.10</a>
</li>
<li>
<a href=/2-4-11/>2.4.11</a>
</li>
<li>
<a href=/2-4-12/>2.4.12</a>
</li>
<li>
<a href=/2-4-13/>2.4.13</a>
</li>
<li>
<a href=/2-4-14/>2.4.14</a>
</li>
<li>
<a href=/2-4-15/>2.4.15</a>
</li>
<li>
<a href=/2-4-16/>2.4.16</a>
</li>
<li>
<a href=/2-4-17/>2.4.17</a>
</li>
<li>
<a href=/2-4-18/>2.4.18</a>
</li>
<li>
<a href=/2-4-19/>2.4.19</a>
</li>
<li>
<a href=/2-4-20/>2.4.20</a>
</li>
<li>
<a href=/2-4-21/>2.4.21</a>
</li>
<li>
<a href=/2-4-22/>2.4.22</a>
</li>
<li>
<a href=/2-4-23/>2.4.23</a>
</li>
<li>
<a href=/2-4-24/>2.4.24</a>
</li>
<li>
<a href=/2-4-25/>2.4.25</a>
</li>
<li>
<a href=/2-4-26/>2.4.26</a>
</li>
<li>
<a href=/2-4-27/>2.4.27</a>
</li>
<li>
<a href=/2-4-28/>2.4.28</a>
</li>
<li>
<a href=/2-4-29/>2.4.29</a>
</li>
<li>
<a href=/2-4-30/>2.4.30</a>
</li>
<li>
<a href=/2-4-31/>2.4.31</a>
</li>
<li>
<a href=/2-4-32/>2.4.32</a>
</li>
<li>
<a href=/2-4-33/>2.4.33</a>
</li>
<li>
<a href=/2-4-34/>2.4.34</a>
</li>
<li>
<a href=/2-4-35/>2.4.35</a>
</li>
<li>
<a href=/2-4-36/>2.4.36</a>
</li>
<li>
<a href=/2-4-37/>2.4.37</a>
</li>
<li>
<a href=/2-4-38/>2.4.38</a>
</li>
<li>
<a href=/2-4-39/>2.4.39</a>
</li>
<li>
<a href=/2-4-40/>2.4.40</a>
</li>
<li>
<a href=/2-4-41/>2.4.41</a>
</li>
<li>
<a href=/2-4-42/>2.4.42</a>
</li>
<li>
<a href=/2-5-1/>2.5.1</a>
</li>
<li>
<a href=/2-5-2/>2.5.2</a>
</li>
<li>
<a href=/2-5-3/>2.5.3</a>
</li>
<li>
<a href=/2-5-4/>2.5.4</a>
</li>
<li>
<a href=/2-5-5/>2.5.5</a>
</li>
<li>
<a href=/2-5-6/>2.5.6</a>
</li>
<li>
<a href=/2-5-7/>2.5.7</a>
</li>
<li>
<a href=/2-5-8/>2.5.8</a>
</li>
<li>
<a href=/2-5-9/>2.5.9</a>
</li>
<li>
<a href=/2-5-10/>2.5.10</a>
</li>
<li>
<a href=/2-5-11/>2.5.11</a>
</li>
<li>
<a href=/2-5-12/>2.5.12</a>
</li>
<li>
<a href=/2-5-13/>2.5.13</a>
</li>
<li>
<a href=/2-5-14/>2.5.14</a>
</li>
<li>
<a href=/2-5-15/>2.5.15</a>
</li>
<li>
<a href=/2-5-16/>2.5.16</a>
</li>
<li>
<a href=/2-5-17/>2.5.17</a>
</li>
<li>
<a href=/2-5-18/>2.5.18</a>
</li>
<li>
<a href=/2-5-19/>2.5.19</a>
</li>
<li>
<a href=/2-5-20/>2.5.20</a>
</li>
<li>
<a href=/2-5-21/>2.5.21</a>
</li>
<li>
<a href=/2-5-22/>2.5.22</a>
</li>
<li>
<a href=/2-5-23/>2.5.23</a>
</li>
<li>
<a href=/2-5-24/>2.5.24</a>
</li>
<li>
<a href=/2-5-25/>2.5.25</a>
</li>
<li>
<a href=/2-5-26/>2.5.26</a>
</li>
<li>
<a href=/2-5-27/>2.5.27</a>
</li>
<li>
<a href=/2-5-28/>2.5.28</a>
</li>
<li>
<a href=/2-5-29/>2.5.29</a>
</li>
<li>
<a href=/2-5-30/>2.5.30</a>
</li>
<li>
<a href=/2-5-31/>2.5.31</a>
</li>
<li>
<a href=/2-5-32/>2.5.32</a>
</li>
<li>
<a href=/2-5-33/>2.5.33</a>
</li>
<li>
<a href=/3-1-1/>3.1.1</a>
</li>
<li>
<a href=/3-1-2/>3.1.2</a>
</li>
<li>
<a href=/3-1-3/>3.1.3</a>
</li>
<li>
<a href=/3-1-4/>3.1.4</a>
</li>
<li>
<a href=/3-1-5/>3.1.5</a>
</li>
<li>
<a href=/3-1-6/>3.1.6</a>
</li>
<li>
<a href=/3-1-7/>3.1.7</a>
</li>
<li>
<a href=/3-1-8/>3.1.8</a>
</li>
<li>
<a href=/3-1-9/>3.1.9</a>
</li>
<li>
<a href=/3-1-10/>3.1.10</a>
</li>
<li>
<a href=/3-1-11/>3.1.11</a>
</li>
<li>
<a href=/3-1-12/>3.1.12</a>
</li>
<li>
<a href=/3-1-13/>3.1.13</a>
</li>
<li>
<a href=/3-1-14/>3.1.14</a>
</li>
<li>
<a href=/3-1-15/>3.1.15</a>
</li>
<li>
<a href=/3-1-16/>3.1.16</a>
</li>
<li>
<a href=/3-1-17/>3.1.17</a>
</li>
<li>
<a href=/3-1-18/>3.1.18</a>
</li>
<li>
<a href=/3-1-19/>3.1.19</a>
</li>
<li>
<a href=/3-1-20/>3.1.20</a>
</li>
<li>
<a href=/3-1-21/>3.1.21</a>
</li>
<li>
<a href=/3-1-22/>3.1.22</a>
</li>
<li>
<a href=/3-1-23/>3.1.23</a>
</li>
<li>
<a href=/3-1-24/>3.1.24</a>
</li>
<li>
<a href=/3-1-25/>3.1.25</a>
</li>
<li>
<a href=/3-1-26/>3.1.26</a>
</li>
<li>
<a href=/3-1-27/>3.1.27</a>
</li>
<li>
<a href=/3-1-28/>3.1.28</a>
</li>
<li>
<a href=/3-1-29/>3.1.29</a>
</li>
<li>
<a href=/3-1-30/>3.1.30</a>
</li>
<li>
<a href=/3-1-31/>3.1.31</a>
</li>
<li>
<a href=/3-1-32/>3.1.32</a>
</li>
<li>
<a href=/3-1-33/>3.1.33</a>
</li>
<li>
<a href=/3-1-34/>3.1.34</a>
</li>
<li>
<a href=/3-1-35/>3.1.35</a>
</li>
<li>
<a href=/3-1-36/>3.1.36</a>
</li>
<li>
<a href=/3-1-37/>3.1.37</a>
</li>
<li>
<a href=/3-1-38/>3.1.38</a>
</li>
<li>
<a href=/3-1-39/>3.1.39</a>
</li>
<li>
<a href=/3-1-40/>3.1.40</a>
</li>
<li>
<a href=/3-1-41/>3.1.41</a>
</li>
<li>
<a href=/3-2-1/>3.2.1</a>
</li>
<li>
<a href=/3-2-2/>3.2.2</a>
</li>
<li>
<a href=/3-2-3/>3.2.3</a>
</li>
<li>
<a href=/3-2-4/>3.2.4</a>
</li>
<li>
<a href=/3-2-5/>3.2.5</a>
</li>
<li>
<a href=/3-2-6/>3.2.6</a>
</li>
<li>
<a href=/3-2-7/>3.2.7</a>
</li>
<li>
<a href=/3-2-8/>3.2.8</a>
</li>
<li>
<a href=/3-2-9/>3.2.9</a>
</li>
<li>
<a href=/3-2-10/>3.2.10</a>
</li>
<li>
<a href=/3-2-11/>3.2.11</a>
</li>
<li>
<a href=/3-2-12/>3.2.12</a>
</li>
<li>
<a href=/3-2-13/>3.2.13</a>
</li>
<li>
<a href=/3-2-14/>3.2.14</a>
</li>
<li>
<a href=/3-2-15/>3.2.15</a>
</li>
<li>
<a href=/3-2-16/>3.2.16</a>
</li>
<li>
<a href=/3-2-17/>3.2.17</a>
</li>
<li>
<a href=/3-2-18/>3.2.18</a>
</li>
<li>
<a href=/3-2-19/>3.2.19</a>
</li>
<li>
<a href=/3-2-20/>3.2.20</a>
</li>
<li>
<a href=/3-2-21/>3.2.21</a>
</li>
<li>
<a href=/3-2-22/>3.2.22</a>
</li>
<li>
<a href=/3-2-23/>3.2.23</a>
</li>
<li>
<a href=/3-2-24/>3.2.24</a>
</li>
<li>
<a href=/3-2-25/>3.2.25</a>
</li>
<li>
<a href=/3-2-26/>3.2.26</a>
</li>
<li>
<a href=/3-2-27/>3.2.27</a>
</li>
<li>
<a href=/3-2-28/>3.2.28</a>
</li>
<li>
<a href=/3-2-29/>3.2.29</a>
</li>
<li>
<a href=/3-2-30/>3.2.30</a>
</li>
<li>
<a href=/3-2-31/>3.2.31</a>
</li>
<li>
<a href=/3-2-32/>3.2.32</a>
</li>
<li>
<a href=/3-2-33/>3.2.33</a>
</li>
<li>
<a href=/3-2-34/>3.2.34</a>
</li>
<li>
<a href=/3-2-35/>3.2.35</a>
</li>
<li>
<a href=/3-2-36/>3.2.36</a>
</li>
<li>
<a href=/3-2-37/>3.2.37</a>
</li>
<li>
<a href=/3-2-38/>3.2.38</a>
</li>
<li>
<a href=/3-2-39/>3.2.39</a>
</li>
<li>
<a href=/3-2-40/>3.2.40</a>
</li>
<li>
<a href=/3-2-41/>3.2.41</a>
</li>
<li>
<a href=/3-2-42/>3.2.42</a>
</li>
<li>
<a href=/3-2-43/>3.2.43</a>
</li>
<li>
<a href=/3-2-44/>3.2.44</a>
</li>
<li>
<a href=/3-2-45/>3.2.45</a>
</li>
<li>
<a href=/3-2-46/>3.2.46</a>
</li>
<li>
<a href=/3-2-47/>3.2.47</a>
</li>
<li>
<a href=/3-3-1/ class=active>3.3.1</a>
</li>
<li>
<a href=/3-3-2/>3.3.2</a>
</li>
<li>
<a href=/3-3-3/>3.3.3</a>
</li>
<li>
<a href=/3-3-4/>3.3.4</a>
</li>
<li>
<a href=/3-3-5/>3.3.5</a>
</li>
<li>
<a href=/thanks/>特别感谢</a>
</li>
<li>
<a href=/run-solution-code/>如何：运行题解代码</a>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>3.3.1</strong>
<label for=toc-control>
</label>
</div>
</header>
<article class=markdown><h1 id=331>
3.3.1
<a class=anchor href=#331>#</a>
</h1>
<h2 id=解答>
解答
<a class=anchor href=#%e8%a7%a3%e7%ad%94>#</a>
</h2>
<p>结果如下：</p>
<pre tabindex=0><code>E

AE

 |--E--|
A       S

 |--E--|
A       SY

 |--ES--|
A   Q   Y

 |--ES--|
A   Q   UY

       |--------S--------|
 |--E--|                 |--U--|
A       Q               T       Y

       |--------S--------|
 |--E--|                 |--U--|
A       IQ               T       Y

       |--------S--------|
 |--EO--|                 |--U--|
A   I   Q               T       Y

       |--------S--------|
 |--EO--|                 |--U--|
A   IN   Q               T       Y
</code></pre><h2 id=代码>
代码
<a class=anchor href=#%e4%bb%a3%e7%a0%81>#</a>
</h2>
<p>2-3 树的实现</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#66d9ef>using</span> System;
<span style=color:#66d9ef>using</span> System.Collections.Generic;
<span style=color:#66d9ef>using</span> System.Linq;
<span style=color:#66d9ef>using</span> System.Text;

<span style=color:#75715e>// ReSharper disable CognitiveComplexity
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>namespace</span> BalancedSearchTree
{
    <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>    <span style=color:#75715e>///     2-3 树。
</span><span style=color:#75715e></span>    <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>    <span style=color:#75715e>/// &lt;typeparam name=&#34;TKey&#34;&gt;键。&lt;/typeparam&gt;
</span><span style=color:#75715e></span>    <span style=color:#75715e>/// &lt;typeparam name=&#34;TValue&#34;&gt;值。&lt;/typeparam&gt;
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TwoThreeBst</span>&lt;TKey, TValue&gt; : IOrderedSt&lt;TKey, TValue&gt;
        <span style=color:#66d9ef>where</span> TKey : IComparable&lt;TKey&gt;
    {
        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> <span style=color:#ae81ff>_</span>count;
        <span style=color:#66d9ef>private</span> Node <span style=color:#ae81ff>_</span>root;

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Put(TKey key, TValue <span style=color:#66d9ef>value</span>)
        {
            <span style=color:#66d9ef>if</span> (<span style=color:#ae81ff>_</span>root == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#ae81ff>_</span>root = <span style=color:#66d9ef>new</span> Node(<span style=color:#66d9ef>null</span>);
                <span style=color:#ae81ff>_</span>root.AddPair(key, <span style=color:#66d9ef>value</span>);
                <span style=color:#66d9ef>return</span>;
            }

            <span style=color:#66d9ef>var</span> (ends, current, <span style=color:#ae81ff>_</span>) = Get(<span style=color:#66d9ef>null</span>, <span style=color:#ae81ff>_</span>root, key);
            <span style=color:#66d9ef>if</span> (current != <span style=color:#66d9ef>null</span>)
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>$&#34;The Key {key} has already been added&#34;</span>);

            ends.AddPair(key, <span style=color:#66d9ef>value</span>);
            <span style=color:#ae81ff>_</span>root = BalanceBottomUp(ends);
            <span style=color:#ae81ff>_</span>count++;
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> TValue Get(TKey key)
        {
            <span style=color:#66d9ef>if</span> (<span style=color:#ae81ff>_</span>root == <span style=color:#66d9ef>null</span>)
                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>default</span>;

            <span style=color:#66d9ef>var</span> (<span style=color:#ae81ff>_</span>, node, index) = Get(<span style=color:#66d9ef>null</span>, <span style=color:#ae81ff>_</span>root, key);
            <span style=color:#66d9ef>if</span> (node == <span style=color:#66d9ef>null</span>)
                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>default</span>;

            <span style=color:#66d9ef>return</span> node.Contents[index].Value;
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Delete(TKey key)
        {
            <span style=color:#66d9ef>var</span> (parent, node, index) = Get(<span style=color:#66d9ef>null</span>, <span style=color:#ae81ff>_</span>root, key);
            <span style=color:#66d9ef>if</span> (node == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;trying to delete a key not exists&#34;</span>);
            }

            <span style=color:#66d9ef>var</span> pairToRemove = node.Contents[index];
            <span style=color:#66d9ef>if</span> (node.IsLeaf())
            {
                <span style=color:#66d9ef>if</span> (parent == <span style=color:#66d9ef>null</span>)
                {
                    <span style=color:#75715e>// root node
</span><span style=color:#75715e></span>                    node.Contents.Remove(pairToRemove);
                    <span style=color:#66d9ef>if</span> (node.Contents.Count == <span style=color:#ae81ff>0</span>)
                    {
                        <span style=color:#ae81ff>_</span>root = <span style=color:#66d9ef>null</span>;
                    }

                    <span style=color:#ae81ff>_</span>count--;
                    <span style=color:#66d9ef>return</span>;
                }
                
                <span style=color:#66d9ef>if</span> (node.Degree == <span style=color:#ae81ff>2</span>)
                {
                    <span style=color:#75715e>// node is 2-node, make it 3 or 4
</span><span style=color:#75715e></span>                    <span style=color:#75715e>// find sibling
</span><span style=color:#75715e></span>                    Node sibling;
                    <span style=color:#66d9ef>if</span> (node == parent.Left)
                    {
                        sibling = parent.Children[<span style=color:#ae81ff>1</span>];
                    }
                    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (node == parent.Right)
                    {
                        sibling = parent.Children[^<span style=color:#ae81ff>2</span>];
                    }
                    <span style=color:#66d9ef>else</span>
                    {
                        sibling = parent.Left.Degree &gt; parent.Right.Degree ? parent.Left : parent.Right;
                    }

                    <span style=color:#66d9ef>if</span> (sibling.Degree == <span style=color:#ae81ff>2</span>)
                    {
                        node = Merge(node, sibling);
                    }
                    <span style=color:#66d9ef>else</span>
                    {
                        node = Redistribution(node, sibling);
                    }
                }

                <span style=color:#75715e>// now node is not 2-node, direct remove
</span><span style=color:#75715e></span>                node.Contents.Remove(pairToRemove);
                <span style=color:#75715e>// all children is null, just delete last one
</span><span style=color:#75715e></span>                node.Children.RemoveAt(node.Degree - <span style=color:#ae81ff>1</span>);
                <span style=color:#ae81ff>_</span>count--;
                <span style=color:#66d9ef>return</span>;
            }

            <span style=color:#66d9ef>var</span> min = Min(node.Right);
            <span style=color:#66d9ef>var</span> t = node.Contents[index];
            node.Contents[index] = min.Contents[<span style=color:#ae81ff>0</span>];
            min.Contents[<span style=color:#ae81ff>0</span>] = t;
            node.Right = DeleteMin(node.Right);
            <span style=color:#ae81ff>_</span>count--;
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> Contains(TKey key)
        {
            <span style=color:#66d9ef>return</span> Get(<span style=color:#66d9ef>null</span>, <span style=color:#ae81ff>_</span>root, key).Node != <span style=color:#66d9ef>null</span>;
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> IsEmpty()
        {
            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>_</span>root == <span style=color:#66d9ef>null</span>;
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Size()
        {
            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>_</span>count;
        }

        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> Size(Node x)
        {
            <span style=color:#66d9ef>if</span> (x == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
            }
            
            <span style=color:#66d9ef>if</span> (x.Degree == <span style=color:#ae81ff>2</span>)
            {
                <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span> + Size(x.Left) + Size(x.Right);
            }

            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>2</span> + Size(x.Left) + Size(x.Middle) + Size(x.Right);
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> IEnumerable&lt;TKey&gt; Keys()
        {
            <span style=color:#66d9ef>if</span> (IsEmpty())
            {
                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> List&lt;TKey&gt;();
            }

            <span style=color:#66d9ef>return</span> Keys(Min(), Max());
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Size(TKey lo, TKey hi)
        {
            <span style=color:#66d9ef>if</span> (lo == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentNullException(nameof(lo), <span style=color:#e6db74>&#34;first argument to Size() is null&#34;</span>);
            }

            <span style=color:#66d9ef>if</span> (hi == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentNullException(nameof(hi), <span style=color:#e6db74>&#34;second argument to Size() is null&#34;</span>);
            }

            <span style=color:#66d9ef>if</span> (lo.CompareTo(hi) &gt; <span style=color:#ae81ff>0</span>)
            {
                <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
            }

            <span style=color:#66d9ef>if</span> (Contains(hi))
            {
                <span style=color:#66d9ef>return</span> Rank(hi) - Rank(lo) + <span style=color:#ae81ff>1</span>;
            }

            <span style=color:#66d9ef>return</span> Rank(hi) - Rank(lo);
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> IEnumerable&lt;TKey&gt; Keys(TKey lo, TKey hi)
        {
            <span style=color:#66d9ef>if</span> (lo == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentNullException(nameof(lo), <span style=color:#e6db74>&#34;first argument to Keys() is null&#34;</span>);
            }

            <span style=color:#66d9ef>if</span> (hi == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentNullException(nameof(hi), <span style=color:#e6db74>&#34;second argument to Keys() is null&#34;</span>);
            }

            <span style=color:#66d9ef>var</span> queue = <span style=color:#66d9ef>new</span> Queue&lt;TKey&gt;();
            Keys(<span style=color:#ae81ff>_</span>root, queue, lo, hi);
            <span style=color:#66d9ef>return</span> queue;
        }

        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> Keys(Node x, Queue&lt;TKey&gt; queue, TKey lo, TKey hi)
        {
            <span style=color:#66d9ef>if</span> (x == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>return</span>;
            }

            <span style=color:#66d9ef>var</span> cmpLo = lo.CompareTo(x.Contents[<span style=color:#ae81ff>0</span>].Key);
            <span style=color:#66d9ef>var</span> cmpHi = hi.CompareTo(x.Contents[<span style=color:#ae81ff>0</span>].Key);
            <span style=color:#66d9ef>if</span> (cmpLo &lt; <span style=color:#ae81ff>0</span>)
            {
                Keys(x.Left, queue, lo, hi);
            }

            <span style=color:#66d9ef>if</span> (cmpLo &lt;= <span style=color:#ae81ff>0</span> &amp;&amp; cmpHi &gt;= <span style=color:#ae81ff>0</span>)
            {
                queue.Enqueue(x.Contents[<span style=color:#ae81ff>0</span>].Key);
            }

            <span style=color:#66d9ef>if</span> (cmpHi &gt; <span style=color:#ae81ff>0</span>)
            {
                Keys(x.Children[<span style=color:#ae81ff>1</span>], queue, lo, hi);
            }

            <span style=color:#75715e>// 3-node extra
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (x.Children.Count == <span style=color:#ae81ff>3</span>)
            {
                cmpLo = lo.CompareTo(x.Contents[<span style=color:#ae81ff>1</span>].Key);
                cmpHi = hi.CompareTo(x.Contents[<span style=color:#ae81ff>1</span>].Key);
                <span style=color:#66d9ef>if</span> (cmpLo &lt; <span style=color:#ae81ff>0</span>)
                {
                    Keys(x.Middle, queue, lo, hi);
                }

                <span style=color:#66d9ef>if</span> (cmpLo &lt;= <span style=color:#ae81ff>0</span> &amp;&amp; cmpHi &gt;= <span style=color:#ae81ff>0</span>)
                {
                    queue.Enqueue(x.Contents[<span style=color:#ae81ff>1</span>].Key);
                }

                <span style=color:#66d9ef>if</span> (cmpHi &gt; <span style=color:#ae81ff>0</span>)
                {
                    Keys(x.Right, queue, lo, hi);
                } 
            }
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> TKey Min()
        {
            <span style=color:#66d9ef>if</span> (IsEmpty())
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;BST is empty&#34;</span>);
            }

            <span style=color:#66d9ef>return</span> Min(<span style=color:#ae81ff>_</span>root).Contents[<span style=color:#ae81ff>0</span>].Key;
        }

        <span style=color:#66d9ef>private</span> Node Min(Node h)
        {
            <span style=color:#66d9ef>if</span> (h.Left == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>return</span> h;
            }

            <span style=color:#66d9ef>return</span> Min(h.Left);
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> TKey Max()
        {
            <span style=color:#66d9ef>if</span> (IsEmpty())
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;BST is empty&#34;</span>);
            }

            <span style=color:#66d9ef>return</span> Max(<span style=color:#ae81ff>_</span>root).Contents[^<span style=color:#ae81ff>1</span>].Key;
        }

        <span style=color:#66d9ef>private</span> Node Max(Node h)
        {
            <span style=color:#66d9ef>if</span> (h.Right == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>return</span> h;
            }

            <span style=color:#66d9ef>return</span> Max(h.Right);
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> TKey Floor(TKey key)
        {
            <span style=color:#66d9ef>if</span> (key == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentNullException(nameof(key), <span style=color:#e6db74>&#34;argument to Floor() is null&#34;</span>);
            }

            <span style=color:#66d9ef>if</span> (IsEmpty())
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;calls Floor() with empty symbol table&#34;</span>);
            }

            <span style=color:#66d9ef>var</span> x = Floor(<span style=color:#ae81ff>_</span>root, key);
            <span style=color:#66d9ef>if</span> (x == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;argument to Floor() is too small&#34;</span>);
            }

            <span style=color:#66d9ef>return</span> x.Contents[<span style=color:#ae81ff>0</span>].Key;
        }

        <span style=color:#66d9ef>private</span> Node Floor(Node x, TKey key)
        {
            <span style=color:#66d9ef>if</span> (x == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
            }

            <span style=color:#66d9ef>var</span> cmp = key.CompareTo(x.Contents[<span style=color:#ae81ff>0</span>].Key);
            <span style=color:#66d9ef>if</span> (cmp == <span style=color:#ae81ff>0</span>)
            {
                <span style=color:#66d9ef>return</span> x;
            }

            <span style=color:#66d9ef>if</span> (cmp &lt; <span style=color:#ae81ff>0</span>)
            {
                <span style=color:#66d9ef>return</span> Floor(x.Left, key);
            }

            <span style=color:#66d9ef>if</span> (x.Degree == <span style=color:#ae81ff>3</span>)
            {
                cmp = key.CompareTo(x.Contents[<span style=color:#ae81ff>1</span>].Key);
                <span style=color:#66d9ef>if</span> (cmp == <span style=color:#ae81ff>0</span>)
                {
                    <span style=color:#66d9ef>return</span> x;
                }

                <span style=color:#66d9ef>if</span> (cmp &lt; <span style=color:#ae81ff>0</span>)
                {
                    <span style=color:#66d9ef>return</span> Floor(x.Middle, key);
                }
            }
            
            <span style=color:#66d9ef>var</span> t = Floor(x.Right, key);
            <span style=color:#66d9ef>if</span> (t != <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>return</span> t;
            }

            <span style=color:#66d9ef>return</span> x;
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> TKey Ceiling(TKey key)
        {
            <span style=color:#66d9ef>if</span> (key == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentNullException(nameof(key), <span style=color:#e6db74>&#34;argument to Ceiling() is null&#34;</span>);
            }

            <span style=color:#66d9ef>if</span> (IsEmpty())
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;calls Ceiling with empty symbol table&#34;</span>);
            }

            <span style=color:#66d9ef>var</span> x = Ceiling(<span style=color:#ae81ff>_</span>root, key);
            <span style=color:#66d9ef>if</span> (x == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;argument to Ceiling is too small&#34;</span>);
            }

            <span style=color:#66d9ef>return</span> x.Contents[^<span style=color:#ae81ff>1</span>].Key;
        }

        <span style=color:#66d9ef>private</span> Node Ceiling(Node x, TKey key)
        {
            <span style=color:#66d9ef>if</span> (x == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
            }

            <span style=color:#66d9ef>var</span> cmp = key.CompareTo(x.Contents[<span style=color:#ae81ff>0</span>].Key);
            <span style=color:#66d9ef>if</span> (cmp == <span style=color:#ae81ff>0</span>)
            {
                <span style=color:#66d9ef>return</span> x;
            }

            <span style=color:#66d9ef>if</span> (cmp &gt; <span style=color:#ae81ff>0</span>)
            {
                <span style=color:#66d9ef>return</span> Ceiling(x.Right, key);
            }

            <span style=color:#66d9ef>if</span> (x.Degree == <span style=color:#ae81ff>3</span>)
            {
                cmp = key.CompareTo(x.Contents[<span style=color:#ae81ff>1</span>].Key);
                <span style=color:#66d9ef>if</span> (cmp == <span style=color:#ae81ff>0</span>)
                {
                    <span style=color:#66d9ef>return</span> x;
                }

                <span style=color:#66d9ef>if</span> (cmp &gt; <span style=color:#ae81ff>0</span>)
                {
                    <span style=color:#66d9ef>return</span> Ceiling(x.Right, key);
                }
            }

            <span style=color:#66d9ef>var</span> t = Ceiling(x.Left, key);
            <span style=color:#66d9ef>if</span> (t != <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>return</span> t;
            }

            <span style=color:#66d9ef>return</span> x;
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Rank(TKey key)
        {
            <span style=color:#66d9ef>if</span> (key == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentNullException(nameof(key), <span style=color:#e6db74>&#34;argument to Rank() is null&#34;</span>);
            }

            <span style=color:#66d9ef>return</span> Rank(<span style=color:#ae81ff>_</span>root, key);
        }

        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> Rank(Node x, TKey key)
        {
            <span style=color:#66d9ef>if</span> (x == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
            }

            <span style=color:#66d9ef>var</span> cmp = key.CompareTo(x.Contents[<span style=color:#ae81ff>0</span>].Key);
            <span style=color:#66d9ef>if</span> (cmp &lt; <span style=color:#ae81ff>0</span>)
            {
                <span style=color:#66d9ef>return</span> Rank(x.Left, key);
            }
            <span style=color:#66d9ef>if</span> (cmp &gt; <span style=color:#ae81ff>0</span>)
            {
                <span style=color:#66d9ef>if</span> (x.Degree == <span style=color:#ae81ff>2</span>)
                {
                    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span> + Size(x.Left) + Rank(x.Right, key);
                }

                cmp = key.CompareTo(x.Contents[<span style=color:#ae81ff>1</span>].Key);
                <span style=color:#66d9ef>if</span> (cmp &lt; <span style=color:#ae81ff>0</span>)
                {
                    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span> + Size(x.Left) + Rank(x.Right, key); 
                }

                <span style=color:#66d9ef>if</span> (cmp &gt; <span style=color:#ae81ff>0</span>)
                {
                    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span> + Size(x.Left) + Size(x.Middle) + Rank(x.Right, key);
                }

                <span style=color:#66d9ef>return</span> Size(x.Left) + Size(x.Middle);
            }

            <span style=color:#66d9ef>return</span> Size(x.Left);
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> TKey Select(<span style=color:#66d9ef>int</span> k)
        {
            <span style=color:#66d9ef>if</span> (k &lt; <span style=color:#ae81ff>0</span> || k &gt;= Size())
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentOutOfRangeException(nameof(k), <span style=color:#e6db74>&#34;argument to Select() is invalid &#34;</span> + k);
            }

            <span style=color:#66d9ef>return</span> Select(<span style=color:#ae81ff>_</span>root, k);
        }

        <span style=color:#66d9ef>private</span> TKey Select(Node x, <span style=color:#66d9ef>int</span> rank)
        {
            <span style=color:#66d9ef>if</span> (x == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>default</span>;
            }

            <span style=color:#66d9ef>var</span> leftSize = Size(x.Left);
            <span style=color:#66d9ef>if</span> (leftSize &gt; rank)
            {
                <span style=color:#66d9ef>return</span> Select(x.Left, rank);
            }

            <span style=color:#66d9ef>if</span> (leftSize &lt; rank)
            {
                <span style=color:#66d9ef>if</span> (x.Degree == <span style=color:#ae81ff>3</span>)
                {
                    leftSize += Size(x.Middle);
                    <span style=color:#66d9ef>if</span> (leftSize &gt; rank)
                    {
                        <span style=color:#66d9ef>return</span> Select(x.Middle, rank - leftSize - <span style=color:#ae81ff>1</span>);
                    }

                    <span style=color:#66d9ef>if</span> (leftSize == rank)
                    {
                        <span style=color:#66d9ef>return</span> x.Contents[<span style=color:#ae81ff>1</span>].Key;
                    }
                }
                
                <span style=color:#66d9ef>return</span> Select(x.Right, rank - leftSize - <span style=color:#ae81ff>1</span>);
            }
            
            <span style=color:#66d9ef>return</span> x.Contents[<span style=color:#ae81ff>0</span>].Key;
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> DeleteMin()
        {
            <span style=color:#66d9ef>if</span> (IsEmpty())
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;BST underflow&#34;</span>);
            }

            <span style=color:#ae81ff>_</span>root = DeleteMin(<span style=color:#ae81ff>_</span>root);
        }

        <span style=color:#66d9ef>private</span> Node DeleteMin(Node x)
        {
            <span style=color:#66d9ef>if</span> (x.Left == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#75715e>// remove left key
</span><span style=color:#75715e></span>                x.Contents.RemoveAt(<span style=color:#ae81ff>0</span>);
                x.Children.RemoveAt(<span style=color:#ae81ff>0</span>);
                <span style=color:#66d9ef>return</span> BalanceBottomUp(x);
            }

            <span style=color:#66d9ef>if</span> (x.Left.Degree != <span style=color:#ae81ff>2</span>)
            {
                <span style=color:#75715e>// left child is not 2-node, do nothing and turn left
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>return</span> DeleteMin(x.Left);
            }
            
            <span style=color:#66d9ef>if</span> (x.Children[<span style=color:#ae81ff>1</span>].Degree &gt; <span style=color:#ae81ff>2</span>)
            {
                <span style=color:#75715e>// sibling is not 2-node, borrow one key into left
</span><span style=color:#75715e></span>                
                <span style=color:#75715e>// get key from parent
</span><span style=color:#75715e></span>                x.Left.AddPair(x.Contents[<span style=color:#ae81ff>0</span>]);
                <span style=color:#75715e>// parent get key from sibling
</span><span style=color:#75715e></span>                x.Contents.RemoveAt(<span style=color:#ae81ff>0</span>);
                x.Contents.Insert(<span style=color:#ae81ff>0</span>, x.Children[<span style=color:#ae81ff>1</span>].Contents[<span style=color:#ae81ff>0</span>]);
                <span style=color:#75715e>// sibling delete min key
</span><span style=color:#75715e></span>                x.Children[<span style=color:#ae81ff>1</span>].Contents.RemoveAt(<span style=color:#ae81ff>0</span>);
                <span style=color:#75715e>// move sibling&#39;s child to left&#39;s child
</span><span style=color:#75715e></span>                x.Left.Children.Add(x.Children[<span style=color:#ae81ff>1</span>].Left);
                x.Children[<span style=color:#ae81ff>1</span>].Children.RemoveAt(<span style=color:#ae81ff>0</span>);

                <span style=color:#66d9ef>return</span> DeleteMin(x.Left);
            }
            
            <span style=color:#75715e>// sibling is 2-node, merge them into 3-node
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (x.Degree == <span style=color:#ae81ff>2</span>)
            {
                <span style=color:#75715e>// current node and its children are all 2-node
</span><span style=color:#75715e></span>                x.AddPair(x.Left.Contents[<span style=color:#ae81ff>0</span>]);
                x.AddPair(x.Right.Contents[<span style=color:#ae81ff>0</span>]);
                x.Left.Children.ForEach(c =&gt; c.Parent = x);
                x.Right.Children.ForEach(c =&gt; c.Parent = x);
                <span style=color:#66d9ef>var</span> t = x.Left;
                x.Left = t.Left;
                x.MiddleLeft = t.Right;
                t = x.Right;
                x.MiddleRight = t.Left;
                x.Right = t.Right;
                <span style=color:#66d9ef>return</span> DeleteMin(x);
            }
            
            x.Left.AddPair(x.Contents[<span style=color:#ae81ff>0</span>]);
            x.Contents.RemoveAt(<span style=color:#ae81ff>0</span>);
            x.Left.AddPair(x.Children[<span style=color:#ae81ff>1</span>].Contents[<span style=color:#ae81ff>0</span>]);
            x.Left.MiddleRight = x.Children[<span style=color:#ae81ff>1</span>].Left;
            x.Left.Right = x.Children[<span style=color:#ae81ff>1</span>].Right;
            x.Children.RemoveAt(<span style=color:#ae81ff>1</span>);
            <span style=color:#66d9ef>return</span> DeleteMin(x.Left);
        }

        <span style=color:#75715e>/// &lt;inheritdoc /&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> DeleteMax()
        {
            <span style=color:#66d9ef>if</span> (IsEmpty())
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;BST is empty&#34;</span>);
            }

            <span style=color:#ae81ff>_</span>root = DeleteMax(<span style=color:#ae81ff>_</span>root);
        }

        <span style=color:#66d9ef>private</span> Node DeleteMax(Node x)
        {
            <span style=color:#66d9ef>if</span> (x.Right == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#75715e>// remove right key
</span><span style=color:#75715e></span>                x.Contents.RemoveAt(x.Contents.Count - <span style=color:#ae81ff>1</span>);
                x.Children.RemoveAt(x.Degree - <span style=color:#ae81ff>1</span>);
                <span style=color:#66d9ef>return</span> BalanceBottomUp(x);
            }

            <span style=color:#66d9ef>if</span> (x.Right.Degree != <span style=color:#ae81ff>2</span>)
            {
                <span style=color:#75715e>// left child is not 2-node, do nothing and turn left
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>return</span> DeleteMax(x.Right);
            }
            
            <span style=color:#66d9ef>if</span> (x.Children[^<span style=color:#ae81ff>2</span>].Degree &gt; <span style=color:#ae81ff>2</span>)
            {
                <span style=color:#75715e>// sibling is not 2-node, borrow one key into left
</span><span style=color:#75715e></span>                
                <span style=color:#75715e>// get key from parent
</span><span style=color:#75715e></span>                x.Right.AddPair(x.Contents[^<span style=color:#ae81ff>1</span>]);
                <span style=color:#75715e>// parent get key from sibling
</span><span style=color:#75715e></span>                x.Contents.RemoveAt(x.Contents.Count - <span style=color:#ae81ff>1</span>);
                x.Contents.Insert(x.Contents.Count - <span style=color:#ae81ff>1</span>, x.Children[^<span style=color:#ae81ff>2</span>].Contents[^<span style=color:#ae81ff>1</span>]);
                <span style=color:#75715e>// sibling delete max key
</span><span style=color:#75715e></span>                x.Children[^<span style=color:#ae81ff>2</span>].Contents.RemoveAt(x.Children[^<span style=color:#ae81ff>2</span>].Contents.Count - <span style=color:#ae81ff>1</span>);
                <span style=color:#75715e>// move sibling&#39;s child to right&#39;s child
</span><span style=color:#75715e></span>                x.Right.Children.Add(x.Children[^<span style=color:#ae81ff>2</span>].Right);
                x.Children[^<span style=color:#ae81ff>2</span>].Children.RemoveAt(x.Children[^<span style=color:#ae81ff>2</span>].Degree - <span style=color:#ae81ff>1</span>);

                <span style=color:#66d9ef>return</span> DeleteMax(x.Right);
            }
            
            <span style=color:#75715e>// sibling is 2-node, merge them into 3-node
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (x.Degree == <span style=color:#ae81ff>2</span>)
            {
                <span style=color:#75715e>// current node and its children are all 2-node
</span><span style=color:#75715e></span>                x.AddPair(x.Left.Contents[<span style=color:#ae81ff>0</span>]);
                x.AddPair(x.Right.Contents[<span style=color:#ae81ff>0</span>]);
                x.Left.Children.ForEach(c =&gt; c.Parent = x);
                x.Right.Children.ForEach(c =&gt; c.Parent = x);
                <span style=color:#66d9ef>var</span> t = x.Left;
                x.Left = t.Left;
                x.MiddleLeft = t.Right;
                t = x.Right;
                x.MiddleRight = t.Left;
                x.Right = t.Right;
                <span style=color:#66d9ef>return</span> DeleteMax(x);
            }
            
            x.Right.AddPair(x.Contents[^<span style=color:#ae81ff>1</span>]);
            x.Contents.RemoveAt(x.Contents.Count - <span style=color:#ae81ff>1</span>);
            x.Right.AddPair(x.Children[^<span style=color:#ae81ff>2</span>].Contents[^<span style=color:#ae81ff>1</span>]);
            x.Left.MiddleRight = x.Children[^<span style=color:#ae81ff>2</span>].Left;
            x.Left.Right = x.Children[^<span style=color:#ae81ff>2</span>].Right;
            x.Children.RemoveAt(x.Degree - <span style=color:#ae81ff>2</span>);
            <span style=color:#66d9ef>return</span> DeleteMax(x.Right);
        }

        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>string</span> ToString()
        {
            <span style=color:#66d9ef>if</span> (IsEmpty())
            {
                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>string</span>.Empty;
            }

            <span style=color:#66d9ef>var</span> maxDepth = Depth(<span style=color:#ae81ff>_</span>root);
            <span style=color:#66d9ef>var</span> layer = <span style=color:#ae81ff>0</span>;
            <span style=color:#66d9ef>var</span> bottomLine = (<span style=color:#66d9ef>int</span>)Math.Pow(<span style=color:#ae81ff>3</span>, maxDepth) * <span style=color:#ae81ff>2</span>;

            <span style=color:#75715e>// BFS
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>var</span> lines = <span style=color:#66d9ef>new</span> List&lt;<span style=color:#66d9ef>string</span>&gt;();
            <span style=color:#66d9ef>var</span> nowLayer = <span style=color:#66d9ef>new</span> Queue&lt;Node&gt;();
            <span style=color:#66d9ef>var</span> nextLayer = <span style=color:#66d9ef>new</span> Queue&lt;Node&gt;();
            nextLayer.Enqueue(<span style=color:#ae81ff>_</span>root);

            <span style=color:#66d9ef>while</span> (layer != maxDepth)
            {
                <span style=color:#66d9ef>var</span> sb = <span style=color:#66d9ef>new</span> StringBuilder();
                <span style=color:#66d9ef>var</span> unitSize = bottomLine / (<span style=color:#66d9ef>int</span>)Math.Pow(<span style=color:#ae81ff>3</span>, layer);
                <span style=color:#66d9ef>var</span> temp = nowLayer;
                nowLayer = nextLayer;
                nextLayer = temp;

                <span style=color:#66d9ef>while</span> (nowLayer.Count != <span style=color:#ae81ff>0</span>)
                {
                    <span style=color:#66d9ef>var</span> x = nowLayer.Dequeue();

                    <span style=color:#66d9ef>if</span> (x != <span style=color:#66d9ef>null</span>)
                    {
                        nextLayer.Enqueue(x.Left);
                        <span style=color:#66d9ef>if</span> (x.Degree == <span style=color:#ae81ff>3</span>)
                            nextLayer.Enqueue(x.Middle);
                        <span style=color:#66d9ef>else</span>
                            nextLayer.Enqueue(<span style=color:#66d9ef>null</span>);
                        nextLayer.Enqueue(x.Right);
                    }
                    <span style=color:#66d9ef>else</span>
                    {
                        nextLayer.Enqueue(<span style=color:#66d9ef>null</span>);
                        nextLayer.Enqueue(<span style=color:#66d9ef>null</span>);
                        nextLayer.Enqueue(<span style=color:#66d9ef>null</span>);
                    }

                    <span style=color:#66d9ef>if</span> (x != <span style=color:#66d9ef>null</span> &amp;&amp; x.Left != <span style=color:#66d9ef>null</span>)
                    {
                        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> i = <span style=color:#ae81ff>0</span>; i &lt; unitSize / <span style=color:#ae81ff>6</span>; i++)
                            sb.Append(<span style=color:#e6db74>&#34; &#34;</span>);
                        sb.Append(<span style=color:#e6db74>&#34;|&#34;</span>);
                        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> i = <span style=color:#ae81ff>1</span>; i &lt; unitSize / <span style=color:#ae81ff>6</span>; i++)
                            sb.Append(<span style=color:#e6db74>&#34;-&#34;</span>);
                    }
                    <span style=color:#66d9ef>else</span>
                    {
                        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> i = <span style=color:#ae81ff>0</span>; i &lt; unitSize / <span style=color:#ae81ff>3</span>; i++)
                            sb.Append(<span style=color:#e6db74>&#34; &#34;</span>);
                    }

                    <span style=color:#66d9ef>if</span> (x == <span style=color:#66d9ef>null</span>)
                        sb.Append(<span style=color:#e6db74>&#34; &#34;</span>);
                    <span style=color:#66d9ef>else</span>
                        sb.Append(x.Contents.Aggregate(<span style=color:#66d9ef>string</span>.Empty, (s, n) =&gt; s + n.Key));

                    <span style=color:#66d9ef>if</span> (x != <span style=color:#66d9ef>null</span> &amp;&amp; x.Right != <span style=color:#66d9ef>null</span>)
                    {
                        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> i = <span style=color:#ae81ff>1</span>; i &lt; unitSize / <span style=color:#ae81ff>6</span>; i++)
                            sb.Append(<span style=color:#e6db74>&#34;-&#34;</span>);
                        sb.Append(<span style=color:#e6db74>&#34;|&#34;</span>);
                        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> i = <span style=color:#ae81ff>1</span>; i &lt; unitSize / <span style=color:#ae81ff>6</span>; i++)
                            sb.Append(<span style=color:#e6db74>&#34; &#34;</span>);
                    }
                    <span style=color:#66d9ef>else</span>
                    {
                        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> i = <span style=color:#ae81ff>1</span>; i &lt; unitSize / <span style=color:#ae81ff>3</span>; i++)
                            sb.Append(<span style=color:#e6db74>&#34; &#34;</span>);
                    }
                }
                lines.Add(sb.ToString());
                layer++;
            }

            <span style=color:#75715e>// Trim
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>var</span> margin = <span style=color:#66d9ef>int</span>.MaxValue;
            <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> line <span style=color:#66d9ef>in</span> lines)
            {
                <span style=color:#66d9ef>var</span> firstNonWhite = <span style=color:#ae81ff>0</span>;
                <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> i = <span style=color:#ae81ff>0</span>; i &lt; line.Length; i++)
                {
                    <span style=color:#66d9ef>if</span> (line[i] == <span style=color:#e6db74>&#39; &#39;</span>) <span style=color:#66d9ef>continue</span>;
                    firstNonWhite = i;
                    <span style=color:#66d9ef>break</span>;
                }

                margin = Math.Min(margin, firstNonWhite);
            }

            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> i = <span style=color:#ae81ff>0</span>; i &lt; lines.Count; i++)
            {
                lines[i] = lines[i].Substring(margin);
            }

            <span style=color:#66d9ef>var</span> result = <span style=color:#66d9ef>new</span> StringBuilder();
            <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> line <span style=color:#66d9ef>in</span> lines)
            {
                result.AppendLine(line);
            }

            <span style=color:#66d9ef>return</span> result.ToString();
        }

        <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// 获取 2-3 树的最大深度。
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;param name=&#34;x&#34;&gt;二叉树的根结点。&lt;/param&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;returns&gt;二叉树的最大深度。&lt;/returns&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> Depth(Node x)
        {
            <span style=color:#66d9ef>if</span> (x == <span style=color:#66d9ef>null</span>) <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
            <span style=color:#66d9ef>if</span> (x.Degree == <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span> + Math.Max(Depth(x.Left), Depth(x.Right));
            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span> + Math.Max(Depth(x.Left), Math.Max(Depth(x.Middle), Depth(x.Right)));
        }
        
        <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// 自底向上对 2-3 树进行平衡。
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;param name=&#34;node&#34;&gt;&lt;/param&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;returns&gt;&lt;/returns&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> Node BalanceBottomUp(Node node)
        {
            <span style=color:#66d9ef>if</span> (node.Degree != <span style=color:#ae81ff>4</span>)
            {
                <span style=color:#75715e>// not 4-node
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>return</span> node.Parent == <span style=color:#66d9ef>null</span> ? node : BalanceBottomUp(node.Parent);
            }

            <span style=color:#75715e>// break 4-node into 2 2-node
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>var</span> left = <span style=color:#66d9ef>new</span> Node(node.Parent);
            left.AddPair(node.Contents[<span style=color:#ae81ff>0</span>]);
            left.Left = node.Left;
            left.Right = node.MiddleLeft;

            <span style=color:#66d9ef>var</span> right = <span style=color:#66d9ef>new</span> Node(node.Parent);
            right.AddPair(node.Contents[<span style=color:#ae81ff>2</span>]);
            right.Left = node.MiddleRight;
            right.Right = node.Right;

            <span style=color:#66d9ef>if</span> (node.Parent == <span style=color:#66d9ef>null</span>)
            {
                <span style=color:#75715e>// root is 4-node
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>var</span> root = <span style=color:#66d9ef>new</span> Node(<span style=color:#66d9ef>null</span>);
                root.AddPair(node.Contents[<span style=color:#ae81ff>1</span>]);
                root.Left = left;
                root.Right = right;
                left.Parent = root;
                right.Parent = root;
                <span style=color:#66d9ef>return</span> root;
            }

            node.Parent.AddPair(node.Contents[<span style=color:#ae81ff>1</span>]);
            <span style=color:#66d9ef>if</span> (node.Parent.Degree == <span style=color:#ae81ff>3</span>)
            {
                <span style=color:#75715e>// parent was 2-node
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>if</span> (node == node.Parent.Children[<span style=color:#ae81ff>0</span>])
                {
                    <span style=color:#75715e>// 4-node is 2-node&#39;s left child
</span><span style=color:#75715e></span>                    node.Parent.Left = left;
                    node.Parent.Middle = right;
                }
                <span style=color:#66d9ef>else</span>
                {
                    <span style=color:#75715e>// 4-node is 2-node&#39;s right child
</span><span style=color:#75715e></span>                    node.Parent.Middle = left;
                    node.Parent.Right = right;
                }

                <span style=color:#66d9ef>return</span> BalanceBottomUp(node.Parent);
            }

            <span style=color:#75715e>// parent was 3-node
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (node == node.Parent.Children[<span style=color:#ae81ff>0</span>])
            {
                <span style=color:#75715e>// 4-node is 3-node&#39;s left child
</span><span style=color:#75715e></span>                node.Parent.Left = left;
                node.Parent.MiddleLeft = right;
            }
            <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (node == node.Parent.Children[<span style=color:#ae81ff>1</span>])
            {
                <span style=color:#75715e>// 4-node is 3-node&#39;s middle child
</span><span style=color:#75715e></span>                node.Parent.MiddleLeft = left;
                node.Parent.MiddleRight = right;
            }
            <span style=color:#66d9ef>else</span>
            {
                <span style=color:#75715e>// 4-node is 3-node&#39;s right child
</span><span style=color:#75715e></span>                node.Parent.MiddleRight = left;
                node.Parent.Right = right;
            }

            <span style=color:#66d9ef>return</span> BalanceBottomUp(node.Parent);
        }

        <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// 在 2-3 树中搜索 &lt;paramref name=&#34;key&#34;/&gt;。
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;param name=&#34;parent&#34;&gt;父结点。&lt;/param&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;param name=&#34;current&#34;&gt;当前结点&lt;/param&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;param name=&#34;key&#34;&gt;要搜索的键。&lt;/param&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;returns&gt;父结点、当前结点和键的下标。&lt;/returns&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> (Node Parent, Node Node, <span style=color:#66d9ef>int</span> Index) Get(Node parent, Node current, TKey key)
        {
            <span style=color:#66d9ef>if</span> (current == <span style=color:#66d9ef>null</span>)
                <span style=color:#66d9ef>return</span> (parent, <span style=color:#66d9ef>null</span>, -<span style=color:#ae81ff>1</span>);

            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> i = <span style=color:#ae81ff>0</span>; i &lt; current.Contents.Count; i++)
            {
                <span style=color:#66d9ef>var</span> pair = current.Contents[i];
                <span style=color:#66d9ef>var</span> cmp = key.CompareTo(pair.Key);
                <span style=color:#66d9ef>if</span> (cmp == <span style=color:#ae81ff>0</span>)
                    <span style=color:#66d9ef>return</span> (parent, current, i);

                <span style=color:#66d9ef>if</span> (cmp &lt; <span style=color:#ae81ff>0</span>)
                    <span style=color:#66d9ef>return</span> Get(current, current.Children[i], key);
            }

            <span style=color:#75715e>// larger to all keys, turn right
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>return</span> Get(current, current.Children[^<span style=color:#ae81ff>1</span>], key);
        }

        <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// 将两个结点合并。
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;param name=&#34;x&#34;&gt;&lt;/param&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;param name=&#34;y&#34;&gt;&lt;/param&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;returns&gt;&lt;/returns&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;exception cref=&#34;InvalidOperationException&#34;&gt;&lt;/exception&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> Node Merge(Node x, Node y)
        {
            <span style=color:#66d9ef>if</span> (x.Degree != <span style=color:#ae81ff>2</span> || y.Degree != <span style=color:#ae81ff>2</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;x and y must all be 2-node to merge&#34;</span>);
            }

            <span style=color:#66d9ef>if</span> (x.Parent != y.Parent)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;two nodes must be siblings to perform merge&#34;</span>);
            }

            <span style=color:#66d9ef>var</span> parent = x.Parent;
            <span style=color:#66d9ef>if</span> (parent.Degree == <span style=color:#ae81ff>2</span>)
            {
                parent.AddPair(x.Contents[<span style=color:#ae81ff>0</span>]);
                parent.AddPair(y.Contents[<span style=color:#ae81ff>0</span>]);
                parent.Left = x.Left;
                parent.MiddleLeft = x.Right;
                parent.MiddleRight = y.Left;
                parent.Right = y.Right;
                <span style=color:#66d9ef>return</span> parent; 
            }

            <span style=color:#66d9ef>if</span> (x == parent.Left || y == parent.Left)
            {
                <span style=color:#75715e>// merge middle to left
</span><span style=color:#75715e></span>                x = parent.Left;
                y = parent.Middle;

                x.AddPair(parent.Contents[<span style=color:#ae81ff>0</span>]);
                x.AddPair(y.Contents[<span style=color:#ae81ff>0</span>]);
                x.MiddleRight = y.Left;
                x.Right = y.Right;
                parent.Contents.RemoveAt(<span style=color:#ae81ff>0</span>);
                parent.Children.Remove(y);
                <span style=color:#66d9ef>return</span> parent;
            }
            
            <span style=color:#75715e>// merge middle to right
</span><span style=color:#75715e></span>            x = parent.Middle;
            y = parent.Right;
            
            y.AddPair(parent.Contents[^<span style=color:#ae81ff>1</span>]);
            y.AddPair(x.Contents[<span style=color:#ae81ff>0</span>]);
            y.Left = x.Left;
            y.MiddleLeft = x.Right;
            parent.Contents.RemoveAt(parent.Contents.Count - <span style=color:#ae81ff>1</span>);
            parent.Children.Remove(x);

            <span style=color:#66d9ef>return</span> parent;
        }

        <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// 合并兄弟结点。
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;param name=&#34;node&#34;&gt;结点。&lt;/param&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;param name=&#34;sibling&#34;&gt;&lt;paramref name=&#34;node&#34;/&gt; 的兄弟结点。&lt;/param&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;returns&gt;&lt;/returns&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;exception cref=&#34;InvalidOperationException&#34;&gt;&lt;/exception&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> Node Redistribution(Node node, Node sibling)
        {
            <span style=color:#66d9ef>if</span> (node.Degree != <span style=color:#ae81ff>2</span> || sibling.Degree == <span style=color:#ae81ff>2</span>)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;node must be 2-node and sibling must not be 2-node&#34;</span>);
            }

            <span style=color:#66d9ef>if</span> (node.Parent != sibling.Parent)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;two nodes must be siblings to perform merge&#34;</span>);
            }

            <span style=color:#66d9ef>var</span> parent = node.Parent;
            <span style=color:#66d9ef>if</span> (node == parent.Left)
            {
                <span style=color:#75715e>// flow to left
</span><span style=color:#75715e></span>                node.AddPair(parent.Contents[<span style=color:#ae81ff>0</span>]);
                node.Right = sibling.Left;
                parent.Contents[<span style=color:#ae81ff>0</span>] = sibling.Contents[<span style=color:#ae81ff>0</span>];
                sibling.Contents.RemoveAt(<span style=color:#ae81ff>0</span>);
                sibling.Children.RemoveAt(<span style=color:#ae81ff>0</span>);
            }
            <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (node == parent.Right)
            {
                <span style=color:#75715e>// flow to right
</span><span style=color:#75715e></span>                node.AddPair(parent.Contents[^<span style=color:#ae81ff>1</span>]);
                node.Left = sibling.Right;
                parent.Contents[^<span style=color:#ae81ff>1</span>] = sibling.Contents[^<span style=color:#ae81ff>1</span>];
                sibling.Contents.RemoveAt(sibling.Contents.Count - <span style=color:#ae81ff>1</span>);
                sibling.Children.RemoveAt(sibling.Children.Count - <span style=color:#ae81ff>1</span>);
            }
            <span style=color:#66d9ef>else</span>
            {
                <span style=color:#75715e>// flow to middle
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>if</span> (sibling == parent.Left)
                {
                    node.AddPair(parent.Contents[<span style=color:#ae81ff>0</span>]);
                    parent.Contents[<span style=color:#ae81ff>0</span>] = sibling.Contents[^<span style=color:#ae81ff>1</span>];
                    node.Children[<span style=color:#ae81ff>0</span>] = sibling.Right;
                    sibling.Contents.RemoveAt(sibling.Contents.Count - <span style=color:#ae81ff>1</span>);
                    sibling.Children.RemoveAt(sibling.Children.Count - <span style=color:#ae81ff>1</span>);
                }
                <span style=color:#66d9ef>else</span>
                {
                    node.AddPair(parent.Contents[^<span style=color:#ae81ff>1</span>]);
                    parent.Contents[^<span style=color:#ae81ff>1</span>] = sibling.Contents[<span style=color:#ae81ff>0</span>];
                    node.Children[^<span style=color:#ae81ff>1</span>] = sibling.Left;
                    sibling.Contents.RemoveAt(<span style=color:#ae81ff>0</span>);
                    sibling.Children.RemoveAt(<span style=color:#ae81ff>0</span>);
                }
            }

            <span style=color:#66d9ef>return</span> node;
        }

        <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// 2-3 树结点。
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Node</span>
        {
            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 构造一个空的 2-3 树结点，并设置父结点。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;param name=&#34;parent&#34;&gt;父结点。&lt;/param&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> Node(Node parent)
            {
                Parent = parent;
            }

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 父结点。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> Node Parent { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
            
            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 结点保存的键值对。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> List&lt;Pair&gt; Contents { <span style=color:#66d9ef>get</span>; } = <span style=color:#66d9ef>new</span>();
            
            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 结点的子结点。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> List&lt;Node&gt; Children { <span style=color:#66d9ef>get</span>; } = <span style=color:#66d9ef>new</span>() { <span style=color:#66d9ef>null</span> };

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 结点的度，例如 2-结点返回的就是 2。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Degree =&gt; Children.Count;

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 左子结点。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> Node Left
            {
                <span style=color:#66d9ef>get</span> =&gt; Children[<span style=color:#ae81ff>0</span>];
                <span style=color:#66d9ef>set</span>
                {
                    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>value</span> != <span style=color:#66d9ef>null</span>)
                        <span style=color:#66d9ef>value</span>.Parent = <span style=color:#66d9ef>this</span>;
                    Children[<span style=color:#ae81ff>0</span>] = <span style=color:#66d9ef>value</span>;
                }
            }

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 第二个子结点，只有当 &lt;see cref=&#34;Degree&#34;/&gt; 是 4 时才可以访问这个属性。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;exception cref=&#34;InvalidOperationException&#34;&gt;&lt;see cref=&#34;Degree&#34;/&gt; 不为 4。&lt;/exception&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> Node MiddleLeft
            {
                <span style=color:#66d9ef>get</span>
                    =&gt; Degree == <span style=color:#ae81ff>4</span>
                        ? Children[<span style=color:#ae81ff>1</span>]
                        : <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;only 4-node has middle left&#34;</span>);
                <span style=color:#66d9ef>set</span>
                {
                    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>value</span> != <span style=color:#66d9ef>null</span>)
                        <span style=color:#66d9ef>value</span>.Parent = <span style=color:#66d9ef>this</span>;
                    Children[<span style=color:#ae81ff>1</span>] = <span style=color:#66d9ef>value</span>;
                }
            }

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 位于中间的子结点，只有当 &lt;see cref=&#34;Degree&#34;/&gt; 为 3 时才可以访问这个属性。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;exception cref=&#34;InvalidOperationException&#34;&gt;&lt;see cref=&#34;Degree&#34;/&gt; 不为 3。&lt;/exception&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> Node Middle
            {
                <span style=color:#66d9ef>get</span> =&gt; Degree == <span style=color:#ae81ff>3</span>
                    ? Children[<span style=color:#ae81ff>1</span>]
                    : <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;only 3-node has middle&#34;</span>);
                <span style=color:#66d9ef>set</span>
                {
                    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>value</span> != <span style=color:#66d9ef>null</span>)
                        <span style=color:#66d9ef>value</span>.Parent = <span style=color:#66d9ef>this</span>;
                    Children[<span style=color:#ae81ff>1</span>] = <span style=color:#66d9ef>value</span>;
                }
            }

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 第三个子结点，只有当 &lt;see cref=&#34;Degree&#34;/&gt; 是 4 时才可以访问这个属性。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;exception cref=&#34;InvalidOperationException&#34;&gt;&lt;see cref=&#34;Degree&#34;/&gt; 不为 4。&lt;/exception&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> Node MiddleRight
            {
                <span style=color:#66d9ef>get</span>
                    =&gt; Degree == <span style=color:#ae81ff>4</span>
                        ? Children[<span style=color:#ae81ff>2</span>]
                        : <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;only 4-node has middle right&#34;</span>);
                <span style=color:#66d9ef>set</span>
                {
                    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>value</span> != <span style=color:#66d9ef>null</span>)
                        <span style=color:#66d9ef>value</span>.Parent = <span style=color:#66d9ef>this</span>;
                    Children[<span style=color:#ae81ff>2</span>] = <span style=color:#66d9ef>value</span>;
                }
            }

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 右子结点。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> Node Right
            {
                <span style=color:#75715e>// ^1 即最后一个，与 Children.Count - 1 等同。
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>get</span> =&gt; Children[^<span style=color:#ae81ff>1</span>];
                <span style=color:#66d9ef>set</span>
                {
                    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>value</span> != <span style=color:#66d9ef>null</span>)
                        <span style=color:#66d9ef>value</span>.Parent = <span style=color:#66d9ef>this</span>;
                    Children[^<span style=color:#ae81ff>1</span>] = <span style=color:#66d9ef>value</span>;
                }
            }

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 向结点添加一个键值对。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;param name=&#34;key&#34;&gt;键。&lt;/param&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;param name=&#34;value&#34;&gt;值。&lt;/param&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> AddPair(TKey key, TValue <span style=color:#66d9ef>value</span>)
            {
                <span style=color:#66d9ef>var</span> pair = <span style=color:#66d9ef>new</span> Pair(key, <span style=color:#66d9ef>value</span>);
                AddPair(pair);
            }

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 向结点添加一个键值对。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;param name=&#34;pair&#34;&gt;键值对。&lt;/param&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> AddPair(Pair pair)
            {
                <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> i = <span style=color:#ae81ff>0</span>; i &lt; Contents.Count; i++)
                {
                    <span style=color:#66d9ef>var</span> cmp = pair.Key.CompareTo(Contents[i].Key);
                    <span style=color:#66d9ef>if</span> (cmp &lt; <span style=color:#ae81ff>0</span>)
                    {
                        Contents.Insert(i, pair);
                        Children.Insert(i + <span style=color:#ae81ff>1</span>, <span style=color:#66d9ef>null</span>);
                        <span style=color:#66d9ef>return</span>;
                    }
                }

                Contents.Add(pair);
                Children.Add(<span style=color:#66d9ef>null</span>);
            }

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 结点是否为叶结点（没有子结点）。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;returns&gt;&lt;/returns&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> IsLeaf()
            {
                <span style=color:#66d9ef>return</span> Children.All(c =&gt; c == <span style=color:#66d9ef>null</span>);
            }

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 拼接并输出结点的键。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;returns&gt;&lt;/returns&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>string</span> ToString()
            {
                <span style=color:#66d9ef>return</span> Contents.Aggregate(<span style=color:#66d9ef>string</span>.Empty, (s, k) =&gt; s + k.Key);
            }
        }

        <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// 键值对。
</span><span style=color:#75715e></span>        <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Pair</span>
        {
            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 新建一个键值对。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;param name=&#34;key&#34;&gt;键。&lt;/param&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;param name=&#34;value&#34;&gt;值。&lt;/param&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> Pair(TKey key, TValue <span style=color:#66d9ef>value</span>)
            {
                Key = key;
                Value = <span style=color:#66d9ef>value</span>;
            }

            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 键。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> TKey Key { <span style=color:#66d9ef>get</span>; }
            
            <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// 值。
</span><span style=color:#75715e></span>            <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>public</span> TValue Value { <span style=color:#66d9ef>get</span>; }
        }
    }
}
</code></pre></div><h2 id=另请参阅>
另请参阅
<a class=anchor href=#%e5%8f%a6%e8%af%b7%e5%8f%82%e9%98%85>#</a>
</h2>
<p>[BalancedSearchTree ](<a href=https://github.com/ikesnowy/Algorithms-4th-Edition-in-Csharp/tree/master/3>https://github.com/ikesnowy/Algorithms-4th-Edition-in-Csharp/tree/master/3</a> Searching/3.3/BalancedSearchTree)</p>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
<div><a class="flex align-center" href=https://github.com/ikesnowy/Algorithms-4th-Edition-in-Csharp//commit/3cf95d07d6d2cd39c1889c1973632d76528ed82f title="Last modified by 沈星繁 | 2022-2-22" target=_blank rel=noopener>
<img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>2022-2-22</span>
</a>
</div>
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
</main>
</body>
</html>